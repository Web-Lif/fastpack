import React from "react";
import ReactDOM from 'react-dom'

{{#if router.paths.vue}}
import Vue from 'vue'

const VueWrapper = ({
    component,
    ...restProps
}: any) => {
    const ref = React.useRef<HTMLDivElement>(null)
    React.useLayoutEffect(() => {
        new Vue({
            render: render => render(component),
            props: restProps
        }).$mount(ref.current);
    }, [])

    return <div ref={ref}/>
}
{{/if}}

const extRouters = [
    {{#each router.paths.react}}
    {
        path: '{{this.path}}',
        component: React.lazy(() => import( /* webpackPrefetch: true */ '../pages{{this.component}}'))
    },
    {{/each}}
] as any

const vueRouters = [
    {{#each router.paths.vue}}
    {
        path: '{{this.path}}'.replace('.', '-'),
        component: React.lazy(
            async () => {
                const component = await import('../pages{{this.component}}')
                return ({
                    default: (props: any) => (
                        <VueWrapper component={component.default} {...props} />
                    )
                })
            }
        )
    },
    {{/each}}
] as any

const routers = extRouters.concat(vueRouters)

export {
    routers,
}
